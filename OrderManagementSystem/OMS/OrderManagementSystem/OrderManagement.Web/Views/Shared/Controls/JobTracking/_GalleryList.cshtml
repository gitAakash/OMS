@model OrderManagement.Web.Models.GalleryModel

<link href="@Url.Content("~/Content/kendo/2014.2.716/kendo.common.min.css")"  rel="stylesheet" type="text/css" />
<link type="text/css" href="@Url.Content("~/Content/kendo/2014.2.716/kendo.flat.min.css")" rel="stylesheet" />
<script type="text/javascript" src="@Url.Content("~/Scripts/kendo/2014.2.716/jquery.min.js")"></script>
<script src="@Url.Content("~/Scripts/kendo/2014.2.716/kendo.web.min.js")" type="text/javascript"></script>



<style>
    

    /*#overlay {
opacity: 0;
background-color: #fff;
position: absolute;
top: 0px;
left: 0px;
z-index: 50;
width: 100%;
height: 100%;
display:none;
}*/
 
/*.info {
margin:auto;
padding:20px;
width:400px;
background:#fff;
box-shadow: 0 4px 16px #999;
z-index: 51;
border:1px solid #acacac;
position:absolute;
display:none;
left: -190px !important;
top: 14px !important;
}*/

/*#overlay {
opacity: 0.7;
background: #000;
width: 132%;
height: 100.5%;
position: fixed;
top: -20px;
left: -257px;
display: none;
    z-index: 9;
}

.info {
margin:auto;
padding:20px;
width:400px;
background:#fff;
box-shadow: 0 4px 16px #999;
z-index: 9999;
border:1px solid #acacac;
position:fixed;
display:none;
left:0 !important;
top:50px !important;
}
.info:hover{z-index:9999;}*/

.info{
background:url(../Images/lightBoxBG_RB.png) repeat left top;
width:133%;
height: 100.5%;
position: fixed;
top: -19px !important;
left: -259px !important;
display:none;
    z-index: 9;}

#results{margin:195px auto 0;
padding:20px;
width:400px;
background:#fff;
box-shadow: 0 4px 16px #999;
z-index: 9999;
border:1px solid #acacac;
/*position:fixed;
left:50px !important;
top:50px !important;*/
    height:310px;
    position: relative;
}

#close {
background: url(../Images/fancybox_sprite.png) repeat;
width: 35px;
height: 35px;
position: absolute;
font-size: 0;
display: block;
top: -15px;
right: -16px;
z-index: 9;}











    div.k-dropzone {
        /*border: 1px solid #c5c5c5;  For Default; Different for each theme */
        border: 1px dashed #C5C5C6;
        margin: 0 0 15px -13px;
        padding: 75px 10px;
    }

        div.k-dropzone:after {
            content: 'Drop Zone';
            color: #000;
            font-style: italic;
            font-size: 30px;
            font-weight: bold;
        }

    div.em {
        visibility: visible;
    }

    .divTagM {
        position: absolute;
        top: 10px;
        width: 94.5%;
        background: #7ED3A6;
        left: 20px;
        padding: 5px;
        border-radius: 4px;
        color: #A31010;
        box-shadow: 0 0 2px #fff;
    }

        .divTagM div {
            float: left;
            margin-right: 10px;
        }

    .divImgDelete {
        position: absolute;
        position: absolute;
        top: 145px;
        background: #f3f3f4;
        left: -3px;
        padding: 3px 5px;
        border-radius: 4px;
        box-shadow: 0 0 2px #fff;
    }

        .divImgDelete div {
            float: left;
            margin-right: 10px;
        }

    .wrapper.wrapper-content.gray-bg .file-box {
        float: left;
        width: 195px;
    }

    .height {
        height: 50px;
        overflow-y: auto;
    }

    .gallery-group .fancybox img {
      margin-bottom: 5px;
      width: 100%;
    }

    .star_empty
    {
        
        background-image: url("../Images/star_empty.png");
        background-repeat: no-repeat;
        width: 16px;
        height: 16px;
        background-size: 16px;
        display: inline-block;
        float: right;
    }
    .star_empty:hover
    {
        background-image: url("../Images/star.png");
    }
    .star
    {
        background-image: url("../Images/star.png");
        background-repeat: no-repeat;
        width: 16px;
        height: 16px;
        background-size: 16px;
        display: inline-block;
        float: right;
    }
    .star_empt
    {
        
        background-image: url("../Images/star_empty.png");
        background-repeat: no-repeat;
        width: 16px;
        height: 16px;
        background-size: 16px;
        display: inline-block;
        float: right;
    }
    .star_empt:hover
    {
        background-image: url("../Images/star.png");
    }

    .mousechange:hover {
        cursor:pointer;
    }

</style>


<div id="divdropzone" style="display: none;">


    <div>
        @* @(Html.Kendo().Upload()
                                                            .Name("files")
                                                            .Async(a => a
                                                                .Save("Save", "JobTracking")
                                                                .Remove("Remove", "JobTracking")
                                                                .AutoUpload(false)

                                                            )
                                                                     .Events(events => events.Upload("onUpload")
                                                                     .Select("onSelect")
                                    // .Success("onSuccess")

                                                                )
                                                        )*@



        @(Html.Kendo().Upload()
                      .Name("files")
                      .TemplateId("fileTemplate")
                      .Async(a => a
                          .Save("Save", "JobTracking")
                          .Remove("Remove", "JobTracking")
                          .AutoUpload(false)
                      )
                      .Events(events => events.Upload("onUpload")
                          .Select("onSelect")
                          .Success("onSuccess")
                      )
                       .Events(c => c.Success("onSuccess"))
                      )


    </div>

    <div id="divFolderUploadMessage" class="divTagM"></div>
    @*  <div id="divTag" class="divTagM">

            @if ((Model != null && Model.TagList != null ) &&  (Model.TagList.Count > 0))
            {
                foreach (var item in Model.TagList)
                {
                <div><input type="checkbox" value='@item.TagName' class="chk">@item.TagName</div>
                 }
             }
            <div style="clear:both;"></div>
        </div> *@
</div>
<div class="row">
    <div class="gallery-group" id="divGalImagelList">

        @if (Model.JobAttachmentlist.Count > 0)
        {

            string strImagesExt = ".bmp .dds .gif .jpg .png .psd .pspimage .tga .thm .tif .tiff .yuv .ai .eps .ps .svg .3dm .3ds .max .obj";
            string strDocuments = ".doc .docx .log .msg .odt .pages .rtf .tex .txt .wpd .wps .pdf";
            string strAudioVideo = ".aif .iff .m3u .m4a .mid .mp3 .mpa .ra .wav .wma .mov .3gp";

            foreach (var image in Model.JobAttachmentlist)
            {

                string FileType = string.Empty;


                if (strImagesExt.Contains(image.FileExtension))
                {
                    FileType = "Images";
                }
                else if (strDocuments.Contains(image.FileExtension)) 
                {
                    FileType = "Documents";
                }
                else if (strAudioVideo.Contains(image.FileExtension))
                {
                    FileType = "AudioVideo";
                }
                else
                {
                    FileType = "Default";
                }

                switch (FileType)
                {
                    case "Images":
                         <div class="file-box">
                            <div class="file">

                                    <span class="corner"></span>
                                    <div class="image">
                                      <!--  <a class="fileDownloadPromise">-->
                                            @*   <img  src= "@Url.Content(image.FilePath)" class="img-responsive"  alt="@image.FileName" />*@

                        <a href="javascript:void(0);" onclick="openlightbox('@image.Row_Id')" id="open">
                                            <img  src="@Url.Content(image.FilePath)" class="img-responsive"  alt="@image.FileName" />
                        </a>
                        <!--   </a>-->//
                         <div id="info_@(image.Row_Id)" class="info">
                        <div id="results">
                           @* <img src="sample.jpg" width="140" style="float: left; margin-right: 20px; margin-bottom: 10px;"/>*@
                              <img  src="@Url.Content(image.FilePath)" class="img-responsive"  alt="@image.FileName" width="540" height="500" style="float: left; margin-right: 20px; margin-bottom: 10px;" />
                            <p style="margin-top: 20px; text-align: right;"><a href="javascript:void(0);" onclick="closelightbox('@image.Row_Id')" id="close">Close1</a></p>
                        </div>
                    </div>
                                    </div>



                                    <div class="file-name">
                                        @image.FileName
                                       
                                        @if (image.Selected.Value)
                                        {
                                        <span class="star mousechange"   row_id="@image.Row_Id"  title="@image.SelectedBy"></span>
                                        }
                                        
                                        else
                                        {
                                            <span class="star_empty mousechange"  row_id="@image.Row_Id"  title="@image.SelectedBy"></span> 
                                        }
                                        

                                        <br>
                                        <small>Added: @image.Created</small>
                                    </div>

                                    <div class="file-name height">
                                        <small><b>Tags: </b>@image.Tags.TrimEnd(',') </small>
                                    </div>

                                
                    <form id="frmDownloadDemo" method="post">
                                            <a  href="javascript:;" class="fancy-icons-download"  title="Download"  id="btnDownload_@image.Row_Id" onclick="Download('@image.Row_Id')"  >dddd</a>
                                           @* <input type="button" class="fileDownloadPromise"  onclick="Download('@image.Row_Id')"  id="1btnDownload_@image.Row_Id" value="Download" row_id="@image.Row_Id" />  *@
                        <iframe id="myIframe" name="myIframe" height="100" style="display: none"></iframe>
                                 </form> 

                                @*onclick="window.open('http://localhost:50858/FileDownload/DownloadReport/0', 'asdas', 'toolbars=0,width=400,height=320,left=200,top=200');" value="Open the window"  *@
                                <a  href="javascript:;" class="fancy-icons close-btn btnDelete" title="Delete"  id="btn_delete_@image.Row_Id" onclick="DeleteGalleryFile('@image.Row_Id')"  ></a>
                                @*  <a  href="javascript:;" class="fancy-icons close-btn fileDownloadPromise" title="Download"  id="btn_download_@image.Row_Id" target: '_blank'  onclick="GetGalleryFile('@image.Row_Id')"  ></a>*@
                                @*<a  href="javascript:;" class="fancy-icons close-btn fileDownloadPromise" title="Download"  id="btn_download_@image.Row_Id"  onclick="downloadGalleryFile('@image.Row_Id')"   ></a>*@
                    
                                

                                <a href="#" class="slider-icon fancy-icons" title=""></a>

                            </div>
                            <div class="divSlide" id="divTagHower">
                                <div class="file-name m-b-xs">
                                    <input type="text" id="txt_@image.Row_Id" class="form-control" oldFileName="@image.FileName" value="@image.FileName"/>
                                </div>

                                @if ((Model != null && Model.TagList != null) && (Model.TagList.Count > 0))
                                {
                                    foreach (var item in Model.TagList)
                                    {
                                    <div>
                            <input type="checkbox" value='@item.TagName' class="chkTag">@item.TagName
                        </div>
                                    }
                                }

                                <div style="clear: both;"></div>
                                <button class="btn btn-primary btn-xs m-t-xs" onclick="UpdateFileInfo('@image.Row_Id')" >Update File</button>
                            </div>
                        </div>
                            break;
                    case "Documents":
                        <div class="file-box">
                        <div class="file">
                            <a href="javascript:;" class="">
                                <span class="corner"></span>
                              
                                @if (".xls".Contains(@image.FileExtension))
                                {
                                  <div class="icon">
                                    <i class="fa fa-bar-chart-o"></i>
                                 </div>
                                }
                                else
                                {
                                 <div class="icon">
                                    <i class="fa fa-file"></i>
                                 </div>
                                }

                                <div class="file-name">
                                    @image.FileName
                                    <br>
                                    <small>Added: @image.Created</small>
                                </div>

                                <div class="file-name height">
                                    <small><b>Tags: </b>@image.Tags.TrimEnd(',') </small>
                                </div>

                            </a>
                    
                    <form id="frmDownloadDemo" method="post">
                                            <a  href="javascript:;" class="fancy-icons-download"  title="Download"  id="btnDownload_@image.Row_Id" onclick="Download('@image.Row_Id')"  >dddd</a>
                        <iframe id="myIframe" name="myIframe" height="100" style="display: none"></iframe>
                             </form> 

                            <a  href="javascript:;" class="fancy-icons close-btn btnDelete" title="Delete"  id="btn_delete_@image.Row_Id" onclick="DeleteGalleryFile('@image.Row_Id')"  ></a>
                            <a href="#" class="slider-icon fancy-icons" title=""></a>

                        </div>
                        <div class="divSlide" id="divTagHower">
                            <div class="file-name m-b-xs">
                                <input type="text" id="txt_@image.Row_Id" class="form-control" oldFileName="@image.FileName" value="@image.FileName"/>
                            </div>

                            @if ((Model != null && Model.TagList != null) && (Model.TagList.Count > 0))
                            {
                                foreach (var item in Model.TagList)
                                {
                                <div>
                            <input type="checkbox" value='@item.TagName' class="chkTag">@item.TagName
                        </div>
                                }
                            }

                            <div style="clear: both;"></div>
                            <button class="btn btn-primary btn-xs m-t-xs" onclick="UpdateFileInfo('@image.Row_Id')" >Update File</button>
                        </div>
                       </div>
                            break;
                    case "AudioVideo":
                        <div class="file-box">
                        <div class="file">
                            <a href="javascript:;" class="">
                                <span class="corner"></span>
                               
                                @if (".mp4.mov.3gp".Contains(@image.FileExtension))
                                {
                                 <div class="icon">
                                    <i class="img-responsive fa fa-film"></i>
                                </div>
                                }
                                else
                                {
                                 <div class="icon">
                                    <i class="fa fa-music"></i>
                                 </div>
                                }

                                <div class="file-name">
                                    @image.FileName
                                    <br>
                                    <small>Added: @image.Created</small>
                                </div>

                                <div class="file-name height">
                                    <small><b>Tags: </b>@image.Tags.TrimEnd(',') </small>
                                </div>

                            </a>
                    
                    <form id="frmDownloadDemo" method="post">
                                            <a  href="javascript:;" class="fancy-icons-download"  title="Download"  id="btnDownload_@image.Row_Id" onclick="Download('@image.Row_Id')"  >dddd</a>
                        <iframe id="myIframe" name="myIframe" height="100" style="display: none"></iframe>
                             </form> 

                            <a  href="javascript:;" class="fancy-icons close-btn btnDelete" title="Delete"  id="btn_delete_@image.Row_Id" onclick="DeleteGalleryFile('@image.Row_Id')"  ></a>
                            <a href="#" class="slider-icon fancy-icons" title=""></a>

                        </div>
                        <div class="divSlide" id="divTagHower">
                            <div class="file-name m-b-xs">
                                <input type="text" id="txt_@image.Row_Id" class="form-control" oldFileName="@image.FileName" value="@image.FileName"/>
                            </div>

                            @if ((Model != null && Model.TagList != null) && (Model.TagList.Count > 0))
                            {
                                foreach (var item in Model.TagList)
                                {
                                <div>
                            <input type="checkbox" value='@item.TagName' class="chkTag">@item.TagName
                        </div>
                                }
                            }

                            <div style="clear: both;"></div>
                            <button class="btn btn-primary btn-xs m-t-xs" onclick="UpdateFileInfo('@image.Row_Id')" >Update File</button>
                        </div>
                       </div>
                            break;
                    case "Default":
                        <div class="file-box">
                        <div class="file">
                            <a href="javascript:;" class="">
                                <span class="corner"></span>
                                <div class="image">
                                    <img  src= "@Url.Content(image.FilePath)" class="img-responsive"  alt="@image.FileName" />
                                </div>
                                <div class="file-name">
                                    @image.FileName
                                    <br>
                                    <small>Added: @image.Created</small>
                                </div>

                                <div class="file-name height">
                                    <small><b>Tags: </b>@image.Tags.TrimEnd(',') </small>
                                </div>

                            </a>
                    
                    <form id="frmDownloadDemo" method="post">
                                            <a  href="javascript:;" class="fancy-icons-download"  title="Download"  id="btnDownload_@image.Row_Id" onclick="Download('@image.Row_Id')"  >dddd</a>
                        <iframe id="myIframe" name="myIframe" height="100" style="display: none"></iframe>
                             </form> 
                            <a  href="javascript:;" class="fancy-icons close-btn btnDelete" title="Delete"  id="btn_delete_@image.Row_Id" onclick="DeleteGalleryFile('@image.Row_Id')"  ></a>
                            <a href="#" class="slider-icon fancy-icons" title=""></a>

                        </div>
                        <div class="divSlide" id="divTagHower">
                            <div class="file-name m-b-xs">
                                <input type="text" id="txt_@image.Row_Id" class="form-control" oldFileName="@image.FileName" value="@image.FileName"/>
                            </div>

                            @if ((Model != null && Model.TagList != null) && (Model.TagList.Count > 0))
                            {
                                foreach (var item in Model.TagList)
                                {
                                <div>
                            <input type="checkbox" value='@item.TagName' class="chkTag">@item.TagName
                        </div>
                                }
                            }

                            <div style="clear: both;"></div>
                            <button class="btn btn-primary btn-xs m-t-xs" onclick="UpdateFileInfo('@image.Row_Id')" >Update File</button>
                        </div>
                       </div>
                            break;
                }
            }

            <div id="overlay"></div>
            
        }
        else
        {
            <div id="divNoRec" class="">
                <div class="middle-box text-center animated fadeInDown">
                    <h3 class="font-bold">Record Not Found</h3>
                    <div class="error-desc">
                        Sorry, but the record you are looking for has note been found. Try checking with other available link in our app.
                    </div>
                </div>
            </div>
        }


        @*<div class="file-box">
            <div class="file">
                <a href="#">
                    <span class="corner"></span>

                    <div class="icon">
                        <i class="fa fa-file"></i>
                    </div>
                    <div class="file-name">
                        Document_2014.doc
                                                                <br>
                        <small>Added: Jan 11, 2014</small>
                    </div>
                </a>
            </div>

        </div>
        <div class="file-box">
            <div class="file">
                <a href="#">
                    <span class="corner"></span>

                    <div class="image">
                        <img src="img/p1.jpg" class="img-responsive" alt="image">
                    </div>
                    <div class="file-name">
                        Italy street.jpg
                                                                <br>
                        <small>Added: Jan 6, 2014</small>
                    </div>
                </a>

            </div>
        </div>
        <div class="file-box">
            <div class="file">
                <a href="#">
                    <span class="corner"></span>

                    <div class="image">
                        <img src="img/p2.jpg" class="img-responsive" alt="image">
                    </div>
                    <div class="file-name">
                        My feel.png
                                                                <br>
                        <small>Added: Jan 7, 2014</small>
                    </div>
                </a>
            </div>
        </div>
        <div class="file-box">
            <div class="file">
                <a href="#">
                    <span class="corner"></span>

                    <div class="icon">
                        <i class="fa fa-music"></i>
                    </div>
                    <div class="file-name">
                        Michal Jackson.mp3
                                                                <br>
                        <small>Added: Jan 22, 2014</small>
                    </div>
                </a>
            </div>
        </div>
        <div class="file-box">
            <div class="file">
                <a href="#">
                    <span class="corner"></span>

                    <div class="image">
                        <img src="img/p3.jpg" class="img-responsive" alt="image">
                    </div>
                    <div class="file-name">
                        Document_2014.doc
                                                                <br>
                        <small>Added: Fab 11, 2014</small>
                    </div>
                </a>
            </div>
        </div>
        <div class="file-box">
            <div class="file">
                <a href="#">
                    <span class="corner"></span>

                    <div class="icon">
                        <i class="img-responsive fa fa-film"></i>
                    </div>
                    <div class="file-name">
                        Monica's birthday.mpg4
                                                                <br>
                        <small>Added: Fab 18, 2014</small>
                    </div>
                </a>
            </div>
        </div>
        <div class="file-box">
            <a href="#">
                <div class="file">
                    <span class="corner"></span>

                    <div class="icon">
                        <i class="fa fa-bar-chart-o"></i>
                    </div>
                    <div class="file-name">
                        Annual report 2014.xls
                                                                <br>
                        <small>Added: Fab 22, 2014</small>
                    </div>
                </div>
            </a>
        </div>
        <div class="file-box">
            <div class="file">
                <a href="#">
                    <span class="corner"></span>

                    <div class="icon">
                        <i class="fa fa-file"></i>
                    </div>
                    <div class="file-name">
                        Document_2014.doc
                                                                <br>
                        <small>Added: Jan 11, 2014</small>
                    </div>
                </a>
            </div>

        </div>
        <div class="file-box">
            <div class="file">
                <a href="#">
                    <span class="corner"></span>

                    <div class="image">
                        <img src="img/p1.jpg" class="img-responsive" alt="image">
                    </div>
                    <div class="file-name">
                        Italy street.jpg
                                                                <br>
                        <small>Added: Jan 6, 2014</small>
                    </div>
                </a>

            </div>
        </div>
        <div class="file-box">
            <div class="file">
                <a href="#">
                    <span class="corner"></span>

                    <div class="image">
                        <img src="img/p2.jpg" class="img-responsive" alt="image">
                    </div>
                    <div class="file-name">
                        My feel.png
                                                                <br>
                        <small>Added: Jan 7, 2014</small>
                    </div>
                </a>
            </div>
        </div>
        <div class="file-box">
            <div class="file">
                <a href="#">
                    <span class="corner"></span>

                    <div class="icon">
                        <i class="fa fa-music"></i>
                    </div>
                    <div class="file-name">
                        Michal Jackson.mp3
                                                                <br>
                        <small>Added: Jan 22, 2014</small>
                    </div>
                </a>
            </div>
        </div>
        <div class="file-box">
            <div class="file">
                <a href="#">
                    <span class="corner"></span>

                    <div class="image">
                        <img src="img/p3.jpg" class="img-responsive" alt="image">
                    </div>
                    <div class="file-name">
                        Document_2014.doc
                                                                <br>
                        <small>Added: Fab 11, 2014</small>
                    </div>
                </a>
            </div>
        </div>
        <div class="file-box">
            <div class="file">
                <a href="#">
                    <span class="corner"></span>

                    <div class="icon">
                        <i class="img-responsive fa fa-film"></i>
                    </div>
                    <div class="file-name">
                        Monica's birthday.mpg4
                                                                <br>
                        <small>Added: Fab 18, 2014</small>
                    </div>
                </a>
            </div>
        </div>
        <div class="file-box">
            <a href="#">
                <div class="file">
                    <span class="corner"></span>

                    <div class="icon">
                        <i class="fa fa-bar-chart-o"></i>
                    </div>
                    <div class="file-name">
                        Annual report 2014.xls
                                                                <br>
                        <small>Added: Fab 22, 2014</small>
                    </div>
                </div>
            </a>
        </div>
        <div class="file-box">
            <div class="file">
                <a href="#">
                    <span class="corner"></span>

                    <div class="icon">
                        <i class="fa fa-file"></i>
                    </div>
                    <div class="file-name">
                        Document_2014.doc
                                                                <br>
                        <small>Added: Jan 11, 2014</small>
                    </div>
                </a>
            </div>

        </div>
        <div class="file-box">
            <div class="file">
                <a href="#">
                    <span class="corner"></span>

                    <div class="image">
                        <img src="img/p1.jpg" class="img-responsive" alt="image">
                    </div>
                    <div class="file-name">
                        Italy street.jpg
                                                                <br>
                        <small>Added: Jan 6, 2014</small>
                    </div>
                </a>

            </div>
        </div>
        <div class="file-box">
            <div class="file">
                <a href="#">
                    <span class="corner"></span>

                    <div class="image">
                        <img src="img/p2.jpg" class="img-responsive" alt="image">
                    </div>
                    <div class="file-name">
                        My feel.png
                                                                <br>
                        <small>Added: Jan 7, 2014</small>
                    </div>
                </a>
            </div>
        </div>
        <div class="file-box">
            <div class="file">
                <a href="#">
                    <span class="corner"></span>

                    <div class="icon">
                        <i class="fa fa-music"></i>
                    </div>
                    <div class="file-name">
                        Michal Jackson.mp3
                                                                <br>
                        <small>Added: Jan 22, 2014</small>
                    </div>
                </a>
            </div>
        </div>
        <div class="file-box">
            <div class="file">
                <a href="#">
                    <span class="corner"></span>

                    <div class="image">
                        <img src="img/p3.jpg" class="img-responsive" alt="image">
                    </div>
                    <div class="file-name">
                        Document_2014.doc
                                                                <br>
                        <small>Added: Fab 11, 2014</small>
                    </div>
                </a>
            </div>
        </div>
        <div class="file-box">
            <div class="file">
                <a href="#">
                    <span class="corner"></span>

                    <div class="icon">
                        <i class="img-responsive fa fa-film"></i>
                    </div>
                    <div class="file-name">
                        Monica's birthday.mpg4
                                                                <br>
                        <small>Added: Fab 18, 2014</small>
                    </div>
                </a>
            </div>
        </div>
        <div class="file-box">
            <a href="#">
                <div class="file">
                    <span class="corner"></span>

                    <div class="icon">
                        <i class="fa fa-bar-chart-o"></i>
                    </div>
                    <div class="file-name">
                        Annual report 2014.xls
                                                                <br>
                        <small>Added: Fab 22, 2014</small>
                    </div>
                </div>
            </a>
        </div>*@

    </div>
</div>

<div id="spaUploadForm"></div>


<script type="text/javascript">
 
    function openlightbox(imageid) {

       // alert("info_" + imageid);
        $('#overlay, #info').animate({ 'opacity': '0.7' }, 300, 'linear');
        $('#info_' + imageid).animate({ 'opacity': '1.00' }, 300, 'linear');
        $('#overlay').css('display', 'block');
        $('#info_' + imageid).css('display', 'block');

        $('#info_' + imageid).css({ 'left': (($(document).width() / 2) - ($('#info_' + imageid).width() / 2)) });
        $('#info_' + imageid).css({ 'top': (($(document).height() / 2) - ($('#info_' + imageid).height() / 2) - 50) });

        $("html, body").animate({ scrollTop: 400 }, "slow");


    }

    function closelightbox(imageid) {
        //alert(imageid);
        $('#overlay').animate({ 'opacity': '0' }, 300, 'linear', function () {
            $('#overlay').css('display', 'none');
        });
        $('#info_' + imageid).animate({ 'opacity': '0' }, 300, 'linear', function () {
            $('#info_' + imageid).css('display', 'none');
        });
    }
</script>


<script type="text/javascript">

    $(document).ready(function () {

        $('.folder-list li a').click(function () {
            $('.folder-list li a').removeClass("active-tab");
            $(this).addClass("active-tab");
        });


        $('.file a.slider-icon').click(function (e) {

            var aParent = $(this).parent();
            $(aParent).next().slideToggle();
            $(".divSlide").not($(aParent).next()).slideUp('fast');
            e.stopPropagation();
            e.preventDefault();
        });

        $('.star_empty').click(function () {
           /* debugger;
            $(this).removeClass('star_empty')
            $(this).addClass('star')*/
           
            var row_id = $(this).attr('row_id');
            SaveSeletecd(row_id, 'true');
            $(this).toggleClass('star');
        });

        $('.star').click(function () {
           /* debugger;
            $(this).removeClass('star')
            $(this).addClass('star_empty')*/
           
      
            var row_id = $(this).attr('row_id');
            SaveSeletecd(row_id,'false');
            //row_id


            $(this).toggleClass('star_empt');
      
        });


        $('.file-box').mouseleave(function (e) {

            $(".divSlide").hide();

        });
    });


    $(".page-number").click(function () {
        alert("Handler for .click() called.");
        var page = parseInt($(this).html());
        // var page = 0;
        $.get('@Url.Action("ImageListing", "JobTracking")', { page: page }, function (data) {
            if (data != null) {
                $("#divGalImagelList").text("");
                $("#divGalImagelList").html(data);
            }
        }

            );
    });



    //$(document).ready(function () {
    //    var elems = Array.prototype.slice.call(document.querySelectorAll('.js-switch'));
    //    elems.forEach(function (html) {
    //        var switchery = new Switchery(html, { color: '#1AB394' });
    //    });
    //});


    function onUpload(e) {
        var groupname = $("#GlobleFolderName").val();
        var groupType = $("#GlobleGroupId").val();
        var JobId = $("#GlobleJobId").val();

        //var tagIds = [];

        //$("#divTag :checked").each(function () {
        //    tagIds.push($(this).val());
        //    tagIds.push($(this).id);
        //    alert( tagIds.push($(this).id));
        //    alert( tagIds.push($(this).name));
        //});


        /* declare an checkbox array */
        var chkArray = [];

        /* look for all checkboes that have a class 'chk' attached to it and check if it was checked */
        $(".chk:checked").each(function () {
            chkArray.push($(this).val());
        });

        /* we join the array separated by the comma */
        var selectedTags;
        selectedTags = chkArray.join(';') + ";";

        if (selectedTags.length <= 1) {
            selectedTags = selectedTags.substring(0, selectedTags.length - 1)
        }

        /* check if there is selected checkboxes, by default the length is 1 as it contains one single comma */
        //if (selectedTags.length > 1) {
        //    alert("You have selected " + selectedTags);
        //} else {
        //    alert("Please at least one of the checkbox");
        //}


        //  alert(tagIds);
        e.data = { JobId: JobId, groupType: groupType, groupname: groupname, selectedTags: selectedTags };
    }

    function onSuccess(e) {

        $(".k-upload-files").remove();
        $(".k-upload-status").remove();
        $(".k-upload.k-header").addClass("k-upload-empty");
        $(".k-upload-button").removeClass("k-state-focused");

        Refreshgallery();

    }

    //function onSelect(e) {

    //    var GroupId =  ($("#GlobleGroupId").val());


    //    var flag = false;
    //    $.each(e.files, function (index, value) {
    //        if (value.extension.toLowerCase() == ".jpeg" || value.extension.toLowerCase() == ".jpg" || value.extension.toLowerCase() == ".png" || value.extension.toLowerCase() == ".cs") {
    //            flag = true;
    //        }
    //        if (!flag) {
    //            alert("Please upload jpeg image files");
    //            e.files.destroy();
    //        }
    //    });
    //}


    function onSelect(e) {
        //  debugger;
        var FileExt = ($("#GlobleFileExtensions").val());
        var MaxFileSize = ($("#GlobleFileSize").val());
        var msgFileSize = CheckFileSize(MaxFileSize);
        var FileExtmsg = FileExt;

        FileExt = FileExt.replace(/\"/g, "", "");

        //    var _validFileExtensions = [".jpg", ".jpeg", ".bmp", ".gif", ".png"];

        var _validFileExtensions = FileExt.split(",");
        var FileSize = MaxFileSize;
        $.each(e.files, function (index, value) {

            for (var j = 0; j < _validFileExtensions.length; j++) {
                var IsValid = false;
                var FileSizeError = false;

                var sCurExtension = _validFileExtensions[j];
                if (value.extension.toLowerCase() == sCurExtension.toLowerCase()) {
                    IsValid = true;
                    FileSizeError = false;

                    if (value.size > Number(FileSize)) {
                        IsValid = true;
                        FileSizeError = false;
                        break;
                    }
                    else {
                        IsValid = true;
                        FileSizeError = true;
                        break;
                    }
                }
            }

            if (!IsValid) {
                alert("Sorry, " + value.extension.toLowerCase() + " File extension is invalid, allowed extensions are: " + FileExt);
                e.files.destroy();

            }
            else if (!FileSizeError) {
                alert("Sorry, File must be under " + msgFileSize + " in size. Your file is too large. Please try again.");
                e.files.destroy();
            }

        });
    }


    function onError(e, status) {
        alert('This file already Exist..');
        //debugger;
        //if (e.status == "customerror") {

        //    switch (e.errors) {
        //        case 'FileExist': alert('This file already Exist..');
        //            break;

        //    }
        //}
        //else {
        //    // alert("Generic server error.");
        //}
    }


    function CheckFileSize(FileSize) {

        var iSize = (FileSize / 1024);

        if (iSize / 1024 > 1) {
            if (((iSize / 1024) / 1024) > 1) {
                iSize = (Math.round(((iSize / 1024) / 1024) * 100) / 100);
                return (iSize + " Gb");
            }
            else {
                iSize = (Math.round((iSize / 1024) * 100) / 100)
                return (iSize + " Mb");
            }
        }
        else {
            iSize = (Math.round(iSize * 100) / 100)
            return (iSize + " kb");
        }
    }

    //function onUpload(e) {
    //    // Array with information about the uploaded files

    //    var totalSize = 0;
    //    // Check the extension of each file and abort the upload if it is not .jpg
    //    $.each(e.files, function (index, value) {

    //        alert(value.size / 1024);
    //        var kb = (value.size / 1024);
    //        totalSize = totalSize + kb;

    //        if (totalSize / 1024 > 25)
    //        {
    //            e.files.destroy();
    //            value.destroy();
    //            alert("You can upload maximum 24 MB");


    //        }

    //    });


    //   // alert(totalSize);
    //}


    function LoadUploadFiles() {
        var page = 0;
        $.get('@Url.Action("ImageListing", "JobTracking")', { page: page }, function (data) {
            if (data != null) {
                $("#spaUploadForm").text("");
                $("#spaUploadForm").html(data);
            }
        });
    }



    

    function SaveSeletecd(rowid, iselected)
    {

        $.get('@Url.Action("UpdateJobAttachmentSelected", "JobTracking")', { rowId: rowid, isSelected: iselected }, function (JsonInfo) {
            var retSelectionSave;
            var retSave;
            var FileNotSaveReason;
           // debugger;
            if (JsonInfo !== null) {
              //  retSave = JsonInfo.Save;
               // FileNotSaveReason = JsonInfo.FileNotSaveReason;
                return true;
                if ((!retSave) && (FileNotSaveReason === 'FileNameExist')) {
                 //   alert("Selection has not been Updated..");
                  //  return false;
                }
                else {
                    return false;
                  //  alert("Selection has been Updated..");
                    // Refresh the page with New Data
                   // Refreshgallery();
                }
            }

          
        });
        

    }

    function UpdateFileInfo(rowid) {
        // debugger;
        var NewFileName = $("#txt_" + rowid).val();
        var oldFileName = $("#txt_" + rowid).attr("oldFileName");

        if (NewFileName.trim().length == 0) {

            $("#txt_" + rowid).css("border", "#E81818 solid 1px");
            $("#txt_" + rowid).css("background", "#F7B9B9");
            $("#txt_" + rowid).focus();
            return;
        }
        else {

            var groupname = $("#GlobleFolderName").val();
            var groupType = $("#GlobleGroupId").val();
            var FileName = $("#GlobleGroupId").val();

            var Row_Id; var TagSelected; var FileName; var Job_id; var Message;

            var GalleryInputModel = { Row_Id: Row_Id, TagSelected: TagSelected, FileName: FileName, Job_id: Job_id, Message: Message };

            /* declare an checkbox array */
            var chkArray = [];

            /* look for all checkboes that have a class 'chk' attached to it and check if it was checked */
            $(".chkTag:checked").each(function () {
                chkArray.push($(this).val());
            });

            /* we join the array separated by the comma */
            var selectedTags;
            selectedTags = chkArray.join(',') + ",";

            if (selectedTags.length <= 1) {
                selectedTags = selectedTags.substring(0, selectedTags.length - 1)
            }


            Row_Id = parseInt(rowid);
            TagSelected = selectedTags;
            NewFileName = NewFileName.replace(" ", "_");;
            Job_id = parseInt($("#GlobleJobId").val());
            oldFileName = oldFileName;


            $.get('@Url.Action("UpdateGallery", "JobTracking")', { Row_Id: Row_Id, TagSelected: TagSelected, NewFileName: NewFileName, Job_id: Job_id, oldFileName: oldFileName, groupname: groupname }, function (JsonInfo) {
                var retFileName;
                var retSave;
                var FileNotSaveReason;

                if (JsonInfo != null) {

                    retSave = JsonInfo.Save;
                    FileNotSaveReason = JsonInfo.FileNotSaveReason;

                    if ((!retSave) && (FileNotSaveReason == 'FileNameExist')) {
                        alert("You can not rename the file becuase same file name exists..");
                        return false;
                    }
                    else {
                        // Refresh the page with New Data
                        Refreshgallery();
                    }
                }
            });
        }
    }

    function DeleteGalleryFile(rowid) {
        // debugger;
        var groupname = $("#GlobleFolderName").val();
        var groupType = $("#GlobleGroupId").val();
        var FileName = $("#GlobleGroupId").val();
        var Row_Id = 0;
        Row_Id = parseInt(rowid);
        if (confirm("Are you sure you want to delete this?")) {
            $.get('@Url.Action("DeleteGalleryFile", "JobTracking")', { Row_Id: Row_Id }, function (data) {
                var message = data.Message;
                if (data != null) {
                    Refreshgallery();
                }
                //  $("#resultMessage").html(message);
            });
        }
    }


    function GetGalleryFile(rowid) {
        // debugger;
        var groupname = $("#GlobleFolderName").val();
        var groupType = $("#GlobleGroupId").val();
        var FileName = $("#txt_" + rowid).attr("oldFileName");
        var Job_id = parseInt($("#GlobleJobId").val());

        var Row_Id = 0;
        Row_Id = parseInt(rowid);

        $.get('@Url.Action("DownloadReport", "JobTracking")', { Row_Id: Row_Id, Job_id: Job_id, groupname: groupname, FileName: FileName }, function (data) {
            if (data != null) {

            }
        });
    }




    


    function Refreshgallery() {
        $('#showGalleryFloder').html('<img src="@Url.Content("~/Images/LoadingImage.gif")"> Loading...');
        var folderName = $("#GlobleFolderName").val();
        var groupid = $("#GlobleGroupId").val();
        var job_Id = $("#GlobleJobId").val();

        $.get('@Url.Action("FolderContent", "JobTracking")', { folderName: folderName, groupid: groupid, job_Id: job_Id }, function (data) {
            if (data != null) {
                $('#showGalleryFloder').html("");
                $('#showGalleryFloder').html(data);
            }
        });
    }

    function downloadGalleryFile(rowid) {
        var url = 'http://test.zerofootprint.com.au/FileDownload/DownloadReport/' + rowid;
        var myWindow = window.open(url, "myWindow", "width=200, height=100");
    }

    $(document).on("click", "a.fileDownloadPromise", function () {

        e.preventDefault();  //stop the browser from following
        var link = $(this).prop('href');
        window.location.href = link;

        return false; //this is critical to stop the click event which will trigger a normal file download
    });


    $("#btnDownload2").click(function () {
        debugger;
        var groupname = $("#GlobleFolderName").val();
        var groupType = $("#GlobleGroupId").val();
        var JobId = $("#GlobleJobId").val();
        var Row_Id = $("#btnDownload").attr("row_id");
        var FileName = $("#txt_" + Row_Id).attr("oldFileName");
      
        var actionUrl = '@Url.Action("DownloadReport", "JobTracking")' + "?Row_Id=" + Row_Id + "&JobId=" + JobId + "&groupname=" + groupname + "&FileName=" + FileName;
        $("#frmDownloadDemo").attr("action", actionUrl);
        $("#frmDownloadDemo").attr("target", "myIframe");
       // $("#frmDownloadDemo").attr("method", "POST");
        $("#frmDownloadDemo").submit();
    });


    function Download(Row_Id) {
        debugger;
        var groupname = $("#GlobleFolderName").val();
        var groupType = $("#GlobleGroupId").val();
        var JobId = $("#GlobleJobId").val();
      
      //  var Row_Id = $("#btnDownload").attr("row_id");
        //Row_Id = $("#btnDownload_" + Row_Id).attr("row_id");
        var FileName = $("#txt_" + Row_Id).attr("oldFileName");

        var actionUrl = '@Url.Action("DownloadReport", "JobTracking")' + "?Row_Id=" + Row_Id + "&JobId=" + JobId + "&groupname=" + groupname + "&FileName=" + FileName;
        $("#frmDownloadDemo").attr("action", actionUrl);
        $("#frmDownloadDemo").attr("target", "myIframe");
        // $("#frmDownloadDemo").attr("method", "POST");
        $("#frmDownloadDemo").submit();
   }






</script>
